<h1 align="center">Linear Regression</h1>

----

$$ 
M(x_1,x_2,x_3) = 1937.964582 -5.157235 x_1 + 496.6025 x_2 + 1116.807677 x_3 
$$ 


$$
\begin{bmatrix}
x_1^{[1]} & x_2^{[1]} & x_3^{[1]} \\
x_1^{[2]} & x_2^{[2]} & x_3^{[2]} \\
\vdots & \vdots & \vdots \\
x_1^{[100]} & x_2^{[100]} & x_3^{[100]}
\end{bmatrix} =
\begin{bmatrix}
201.8647 & 1.0 & 1.0 \\
398.9774 & 0.0 & 1.2 \\
330.7531 & 1.0 & 1.0 \\
66.0156 & 0.0 & 0.8 \\
309.7027 & 0.0 & 1.2 \\
161.3583 & 1.0 & 1.2 \\
116.1831 & 1.0 & 0.8 \\
339.2498 & 1.0 & 0.8 \\
261.4119 & 0.0 & 1.2 \\
86.607 & 0.0 & 1.0 \\
224.6746 & 0.0 & 1.2 \\
482.6379 & 0.0 & 1.0 \\
184.0367 & 0.0 & 1.2 \\
208.6165 & 1.0 & 1.0 \\
122.6153 & 1.0 & 0.8 \\
155.1607 & 0.0 & 0.8 \\
271.6781 & 1.0 & 1.2 \\
420.4519 & 0.0 & 1.0 \\
287.2648 & 0.0 & 1.0 \\
231.0326 & 1.0 & 0.8 \\
372.9922 & 1.0 & 0.8 \\
101.7198 & 0.0 & 1.2 \\
475.5874 & 0.0 & 1.0 \\
330.689 & 1.0 & 1.0 \\
383.7323 & 0.0 & 1.0 \\
175.0248 & 1.0 & 0.8 \\
222.7248 & 0.0 & 1.2 \\
235.2865 & 0.0 & 1.2 \\
254.2815 & 0.0 & 1.0 \\
345.7389 & 1.0 & 1.2 \\
371.5682 & 0.0 & 0.8 \\
100.1805 & 0.0 & 1.2 \\
357.1432 & 1.0 & 0.8 \\
430.2678 & 1.0 & 1.0 \\
438.9038 & 0.0 & 1.0 \\
391.4219 & 0.0 & 1.0 \\
338.4887 & 0.0 & 1.2 \\
223.294 & 1.0 & 1.0 \\
369.2475 & 0.0 & 1.2 \\
235.408 & 1.0 & 1.2 \\
72.189 & 1.0 & 1.2 \\
413.7788 & 0.0 & 1.0 \\
155.0283 & 0.0 & 1.2 \\
58.2047 & 0.0 & 1.2 \\
216.4499 & 0.0 & 0.8 \\
248.0686 & 1.0 & 1.2 \\
139.6489 & 1.0 & 1.2 \\
367.3126 & 0.0 & 0.8 \\
254.4698 & 0.0 & 1.2 \\
469.2892 & 1.0 & 0.8 \\
133.5799 & 1.0 & 1.0 \\
314.5079 & 1.0 & 0.8 \\
341.8091 & 0.0 & 0.8 \\
470.1269 & 0.0 & 1.2 \\
387.9229 & 0.0 & 1.2 \\
211.7025 & 0.0 & 0.8 \\
283.4154 & 1.0 & 1.0 \\
303.2099 & 1.0 & 1.2 \\
269.4325 & 0.0 & 1.0 \\
298.6254 & 0.0 & 1.2 \\
185.4336 & 1.0 & 1.2 \\
173.703 & 1.0 & 1.0 \\
294.8489 & 0.0 & 1.0 \\
389.998 & 1.0 & 0.8 \\
339.61 & 1.0 & 1.0 \\
471.2565 & 1.0 & 1.2 \\
205.3365 & 0.0 & 1.2 \\
395.8105 & 1.0 & 0.8 \\
460.1038 & 1.0 & 1.0 \\
273.8929 & 1.0 & 0.8 \\
499.4568 & 0.0 & 1.2 \\
465.1247 & 1.0 & 1.0 \\
191.244 & 1.0 & 1.0 \\
118.2178 & 0.0 & 1.0 \\
493.1863 & 1.0 & 1.2 \\
68.1464 & 0.0 & 1.2 \\
471.5734 & 1.0 & 0.8 \\
208.2694 & 1.0 & 0.8 \\
81.4379 & 0.0 & 1.0 \\
483.5275 & 1.0 & 1.0 \\
308.9973 & 0.0 & 0.8 \\
128.9171 & 0.0 & 0.8 \\
274.2499 & 1.0 & 1.2 \\
297.7985 & 0.0 & 1.0 \\
283.1069 & 1.0 & 1.0 \\
215.802 & 0.0 & 1.0 \\
207.7342 & 1.0 & 0.8 \\
457.7392 & 1.0 & 1.2 \\
286.4122 & 1.0 & 1.2 \\
276.75 & 1.0 & 0.8 \\
175.8206 & 1.0 & 1.2 \\
455.5666 & 0.0 & 1.2 \\
273.2988 & 1.0 & 1.2 \\
395.2347 & 0.0 & 1.2 \\
249.1455 & 1.0 & 0.8 \\
258.7918 & 0.0 & 0.8 \\
416.3939 & 0.0 & 1.0 \\
435.5285 & 1.0 & 1.2 \\
227.1568 & 0.0 & 0.8 \\
249.0772 & 0.0 & 1.2 \\
\end{bmatrix}
$$


$$
\begin{align}
d^{[i]} &= \left(x_1 - x_1^{[i]}\right)^2 + \left(x_2 - x_2^{[i]}\right)^2 + \left(x_3 - x_3^{[i]}\right)^2, \quad i = 1,2,\cdots, n \\
d &= \left[d^{[1]}, d^{[2]}, \cdots, d^{[100]}\right]^T \\
\delta &= \text{min}\_3(d) \\
M(x_1,x_2,x_3) &= \frac{\sum_{i=1}^{m} \mathbb{I}(d^{[i]} \leq \delta) \cdot y^{[i]}}{\sum_{i=1}^{m} \mathbb{I}(d^{[i]} \leq \delta)}
\end{align}
$$

----

To get the model, we just use the simplest way of linear regression. Firstly, we randomly separate the dataset into train and test dataset with a ratio of 7:3. 

- Train Indices: 12,  48,  86,  29,  94,   6,  67,  66,  36,  17,  50,  35,   8,
             96,  28,  20,  82,  26,  63,  14,  25,   4,  18,  39,   9,  79,
              7,  65,  37,  90,  57, 100,  55,  44,  51,  68,  47,  69,  62,
             98,  80,  42,  59,  49,  99,  58,  76,  33,  95,  60,  64,  85,
             38,  30,   2,  53,  22,   3,  24,  88,  92,  75,  87,  83,  21,
             61,  72,  15,  93,  52
- Test Indices: 84, 54, 71, 46, 45, 40, 23, 81, 11,  1, 19, 31, 74, 34, 91,  5, 77,
            78, 13, 32, 56, 89, 27, 43, 70, 16, 41, 97, 10, 73

Then we fit the linear regression model by computing:

$\beta = (X^TX)^{-1}X^Ty$, and round the result into 6 decimal points, which yields that:

$$
M(x_1,x_2,x_3) = 1937.964582 -5.157235 x_1 + 496.6025 x_2 + 1116.807677 x_3
$$

We also compute the evaluation metrics:\
Training Set MAD: 72.18050734762957\
Training Set MSE: 8340.06694071241\
Training Set RMSE: 91.32396695672178\
Training Set R-squared: 0.979544712974249\
Test Set MAD: 74.77093912630646\
Test Set MSE: 8689.619505183051\
Test Set RMSE: 93.21812862948414\
Test Set R-squared: 0.9833155409384102\
Population MAD: 83.3727744983166\
Population MSE: 10883.980736279285\
Population RMSE: 104.32631852164288\
Population R-squared: 0.9791080689152433

âš  Population Metrics are invisible to users. We can compute it because this is artificial dataset
